<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>基础地图</title>
    <link rel="stylesheet" href="http://minedata.cn/minemapapi/v1.1/minemap.css">
    <script src="../../dist/minemap-dev.js"></script>
    <style>
        html,
        body,
        #map {
            width: 100%;
            height: 100%;
        }

        html,
        body {
            margin: 0;
            padding: 0;
        }
    </style>
</head>

<body>
<div id="map"></div>
<script>
    minemap.accessToken = '0b871b483cfb42a7b0dd73b5f78792e8';
    minemap.solution = 66;
    minemap.spriteUrl = 'car';
    minemap.TRW = {
        date: 1481635239,
        request: function () {
            this.date += 20;
            if (this.date >= 1481635786) {
                this.date = 1481635239;
            }
            if (map.getSource('symtracking')) map.removeSource('symtracking');
        },
        replace: function () {
            map.addSource("symtracking", {
                'type': 'vector',
                'tiles': ['http://123.207.109.239:8082/test/trackingpoctb/{z}/{x}/{y}']
            })
        }
    }

    var map = new minemap.Map({
        container: 'map',
        style: "http://minedata.cn/service/solu/style/id/318",
        center: [116.492667,40.185758500167],
        zoom: 10,
        pitch: 0
    });
    map.repaint = true;

    map.on('load', function () {
        map.addSource("symtracking", {
            'type': 'vector',
            'tiles': ['http://123.207.109.239:8082/test/trackingpoctb/{z}/{x}/{y}']
        })
        map.addLayer({
            "type": "symtracking",
            "source": "symtracking",
            "id": "histogram_3d",
            "source-layer": "link",
            "layout": {
                "icon-image": "arrow",
                "icon-allow-overlap": false,
                "icon-ignore-placement": true,
                "symbol-avoid-edges": false,
                "symbol-placement": "line",
                "symtracking-fps": 1,
                "symtracking-time-segment": 20
            }
        });
    });
</script>
</body>
