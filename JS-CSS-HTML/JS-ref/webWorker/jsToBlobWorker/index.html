<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width">
  <title>.js - blob- worker</title>
  <link rel="stylesheet" href="">
  <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>

<body>
  <script>
    class WebWorker {
      constructor(worker) {
        const code = worker.toString();
        const blob = new Blob(['(' + code + ')()']);
        return new Worker(URL.createObjectURL(blob));
      }
    }
    // w = new WebWorker(require('./w.js'));
    var reader = new FileReader();
    reader.onload = function (e) {
      var text = reader.result;
      console.log('t', text)
    }

    reader.readAsText('./w.js');
    w = new WebWorker('');
    w.addEventListener('message', (event) => {
      const d = event.data;
      console.log('data', d);
    });

    function say() {
      w && w.postMessage('Daniel');
    }
  </script>
  <button click='say'>
    say hello
  </button>

</html>